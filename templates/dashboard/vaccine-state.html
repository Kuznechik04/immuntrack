<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Einreisestatus Weltkarte</title>
  <style>
    #map {
      width: 100%;
      height: 600px;
    }
  </style>
  <!-- Kartenskripte -->
  <script src="{{ url_for('static', filename='map/mapdata.js') }}"></script>
  <script src="{{ url_for('static', filename='map/simplemaps_worldmap.js') }}"></script>
</head>
<body>
  <h2>Einreise-Status weltweit</h2>
  <p>Diese Weltkarte zeigt, in welche Länder Du basierend auf deinem Impfstatus einreisen darfst.</p>

  <div id="map"></div>

  <!-- Impfstatus aus Flask -->
  <script>
    window.impfstatus = {{ impfstatus | tojson | safe }};
    console.log("✅ Impfstatus geladen:", window.impfstatus);
  </script>

  <!-- Dynamische Färbung der Länder -->
  <script>
    const farben = ["#4caf50", "#ffeb3b", "#ff9800", "#f44336"];
    const mapcolors = {};

    Object.entries(window.impfstatus).forEach(([iso, fehlend]) => {
      let farbe;
      if (fehlend === 0) farbe = farben[0];
      else if (fehlend <= 2) farbe = farben[1];
      else if (fehlend <= 4) farbe = farben[2];
      else farbe = farben[3];
      mapcolors[iso] = farbe;
    });

    window.onload = function () {
      if (typeof mapSettings !== "undefined") {
        mapSettings.general.fill = "#DDDDDD";
        mapSettings.state_specific = mapSettings.state_specific || {};
        for (const [iso, farbe] of Object.entries(mapcolors)) {
          if (!mapSettings.state_specific[iso]) mapSettings.state_specific[iso] = {};
          mapSettings.state_specific[iso].color = farbe;
        }
      }
    };
  </script>

  <div class="country-info">
    <h3>Informationen zu den Ländern</h3>
    <ul>
      <li><strong>Deutschland:</strong> Einreise ohne Einschränkungen.</li>
      <li><strong>Frankreich:</strong> Einreise mit Nachweis des Impfstatus.</li>
      <li><strong>USA:</strong> Einreise nur mit vollständigem Impfschutz.</li>
      <li><strong>Spanien:</strong> Einreise mit Nachweis des Impfstatus.</li>
      <li><strong>Italien:</strong> Einreise ohne Einschränkungen.</li>
    </ul>
    <p>Bitte beachte, dass sich die Einreisebestimmungen jederzeit ändern können. Informiere dich vor deiner Reise über die aktuellen Bestimmungen.</p>
    <p>Für weitere Informationen zu den Einreisebestimmungen in anderen Ländern, besuche bitte die offizielle Webseite des Auswärtigen Amtes.</p>
  </div>
</body>
</html>
